<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão de Entregas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-900 text-gray-200 flex min-h-screen">

    <!-- Sidebar -->
    <aside class="w-64 bg-gray-800 p-6 flex-shrink-0">
        <div class="flex items-center mb-10">
            <i class="fas fa-truck-fast text-2xl text-blue-500 mr-3"></i>
            <h1 class="text-xl font-bold text-white">Gestão Logística</h1>
        </div>
        <nav id="sidebar-nav" class="space-y-3">
            <button data-page="dashboard" class="nav-button w-full text-left flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200 tab-active">
                <i class="fas fa-chart-pie w-6 text-center mr-3"></i>
                <span>Dashboard</span>
            </button>
            <button data-page="viagens" class="nav-button w-full text-left flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200">
                <i class="fas fa-route w-6 text-center mr-3"></i>
                <span>Controle de Viagens</span>
            </button>
            <button data-page="colaboradores" class="nav-button w-full text-left flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200">
                <i class="fas fa-users w-6 text-center mr-3"></i>
                <span>Colaboradores</span>
            </button>
        </nav>
    </aside>

    <!-- Main Content -->
    <main id="content-area" class="flex-1 p-8 overflow-y-auto">
        <!-- O conteúdo da página será carregado aqui -->
    </main>
    
    <script type="module">
        // Importa as funções necessárias dos módulos do Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Substitua pela configuração do seu projeto Firebase
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            apiKey: "AIzaSyDCTVFN0ceTLrAQypqNW9gtWQvwri0YMq4",
            authDomain: "gestaomarcos-21481.firebaseapp.com",
            projectId: "gestaomarcos-21481",
            storageBucket: "gestaomarcos-21481.firebasestorage.app",
            messagingSenderId: "800903289189",
            appId: "1:800903289189:web:e03207adf988779ac3a98c",
            measurementId: "G-74G1QX37HT"
        };
        
        // Verifica se a configuração foi preenchida
        if (firebaseConfig.apiKey === "SUA_API_KEY") {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <div class="bg-red-900 border-l-4 border-red-500 text-red-100 p-4" role="alert">
                    <p class="font-bold">Erro de Configuração</p>
                    <p>A configuração do Firebase não foi encontrada. Por favor, adicione as credenciais do seu projeto no arquivo <strong>index.html</strong> para continuar.</p>
                </div>
            `;
        } else {
            // Inicializa o Firebase
            try {
                const app = initializeApp(firebaseConfig);
                const auth = getAuth(app);
                const db = getFirestore(app);
                
                // Expondo as instâncias para o escopo global
                window.db = db;
                window.auth = auth;

                // Faz login anônimo
                await signInAnonymously(auth);
                console.log("User is signed in:", auth.currentUser.uid);
                
                // Dispara um evento customizado quando a autenticação estiver pronta
                window.dispatchEvent(new CustomEvent('auth-ready'));

            } catch (error) {
                console.error("Firebase initialization failed:", error);
                const contentArea = document.getElementById('content-area');
                contentArea.innerHTML = `
                <div class="bg-red-900 border-l-4 border-red-500 text-red-100 p-4" role="alert">
                    <p class="font-bold">Erro de Conexão com Firebase</p>
                    <p>Não foi possível conectar ao Firebase. Verifique suas credenciais e as regras de segurança do seu projeto. Detalhes: ${error.message}</p>
                </div>
                `;
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <script type="module" src="js/main.js" defer></script>
</body>
</html>

